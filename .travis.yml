dist: xenial
services:
- postgresql
addons:
  postgresql: '9.4'
before_script:
- psql -U postgres -c "create user board password 'board'"
- psql -U postgres -c "ALTER ROLE board superuser"
- psql -U postgres -c "create database boardDB owner board"
- psql -U postgres -c "ALTER USER board CREATEDB"
language: python
python:
- '3.6'
install:
- pip install -r requirements.txt
- pip install codacy-coverage
- pip install coverage
script:
- cd board
- python ./manage.py makemigrations
- python ./manage.py migrate --run-syncdb
- python ./manage.py test --keepdb
- coverage run --branch --source=. ./manage.py test --keepdb
- coverage xml
- python-codacy-coverage -r coverage.xml
deploy:
  provider: heroku
  app: tryonboard-sprint1
  strategy: git
  api_key:
    secure: Skui+af7MnTJKDAWJump0xcfW+0nqqPNFRV9D1ZLjTMpfZtNOH81hwx2m3oPmHNV4HwY9J0xVBDxdUjRHR0ovdbGeJMfr8fhnzoVsb7GUomdohbXfCB+yNLHV3IkwQVivoQOyTkLcEasgYXwRYH+jx5g7QNXtsNEMUbQtWyxso0wgZLdO+JvU0jcrzA1SWD/t4HA/NOz3U3NY0TCQK/8bkGgsesATIZwfhaAQiyVYbEWla1JTpn+zi4zadUBvRp9NbjQZCK6B1pIVKflRnZOyKwbY/yO4iodBpwZ01uoOORcCcoCjM2qw5fCEETooIy4UmbQ1W0Re1XRKp9S5PgSCS3Pc79yYG8divxRwSbAAwdBUB71ykQ3Ls5C4ahZdIm8AFj3LRz6v8d0afxbHRa05UfEiS6YLkyilPXgboiOFAKaIuJ14JkDQkqZhhEoOEwnc07E14AfFopfh/i02X/bRSQICULcpWbKi51mCAusKcB9uVTMtP8pF+Wfm7lk29garHr0HiQXl2C9QOWSPy+RpkZ0RZxFjDKOZG5aEQySSHC3lLzDKflno1qTgDMfzNMPHweaPDFpQqD788NwNMdkOsBYoayANJz9Q58vTVv4iAWvEImUbgqPkghx5umoEOisifBDbdaqlwI1jUVezHZPWGjSbZVmdMgCeXqJPm9eYgs=
