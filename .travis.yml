dist: xenial
services:
- postgresql
addons:
  postgresql: '9.4'
before_script:
- psql -U postgres -c "create user board password 'board'"
- psql -U postgres -c "create database boardDB owner board"
- psql -U postgres -c "ALTER USER board CREATEDB"
language: python
python:
- '3.6'
install:
- pip install -r requirements.txt
- pip install codacy-coverage
- pip install coverage
script:
- cd board
- python ./manage.py makemigrations
- python ./manage.py migrate --run-syncdb
- python ./manage.py test --keepdb
- coverage run --branch --source=. ./manage.py test --keepdb
- coverage xml 
- python-codacy-coverage -r coverage.xml
branches:
  only:
  - develop
deploy:
  provider: heroku
  app: tryonboard-sprint1
  strategy: git
  on:
    branches: develop
  api_key:
    secure: pA8Mb3i99bmxUx3Npnnc7ljZ4dnoPpV6MUGH4JgOEMNr5rzKi3h6WHMRcyT+hIvOaSV7hQAaMBCqu+xs89JMf7GtaCbx9EqFnCOO3iDQNsTjLFTOuYkpYuEHPh+nY1dqp1DzcUJwHzINWu1S/IsFXqYsJjGNz7UQ8CZL9EwWxMHx3+suvRG2alEAlsBIomrgXjwt2fiIDlTe0g0sTqOPWWCVMEkPAA7xEB2bium7xLv8+37OjIiRsUXb2leHW27yUbvFdCXNLYTDLQtTUvWqhknw7ZhYmPjuhmhNSe3pFDQyKQp+aUTvZEVUDe9hE3xByheyw438cSEvH8h8kNgLbrI6eA5nv7ityvNT9+L8mZL4Ym3Z90rW3UIJWeNVEUvnphsqr7nofo1Wt36rz1YE7QiOWKSW46XWQk9OqooQEzYZ7/pCtH9HUtV2dtxi4gf/0B6iQOvhWSEbRgT+DWSd//VfLuAVp4z9cIreyc3OrfSEfZ77FF8hRJpZWDWcNX1J8Dv2Vf8roADkTtMWpVrm1Exp4nudW9bUEjAhIIWSeUFIAhhbZSUKCi72240/wXRr0uh+AI/xISnzbNZYMfAz1xn0WUxX2QNdgIrDLtpIKlSdwyN5CA+lDZTg8+6TQqyiScWicrpVXWki5p3Hf9QDpzdUFcDVDYtKCEM4PXKvD9o=
